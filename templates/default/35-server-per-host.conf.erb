# Generated by Chef
# Local modifications will be overwritten

<% if node[:rackspace_rsyslog][:config][:use_relp] -%>
$ModLoad imrelp
$InputRELPServerRun <%= node[:rackspace_rsyslog][:config][:relp_port] %>
<% end -%>
$DirGroup <%= node[:rackspace_rsyslog][:config][:group] %>
$DirCreateMode 0755
$FileGroup <%= node[:rackspace_rsyslog][:config][:group] %>

$template PerHostAuth,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/auth.log"
$template PerHostCron,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/cron.log"
$template PerHostSyslog,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/syslog"
$template PerHostDaemon,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/daemon.log"
$template PerHostKern,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/kern.log"
$template PerHostLpr,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/lpr.log"
$template PerHostUser,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/user.log"
$template PerHostMail,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/mail.log"
$template PerHostMailInfo,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/mail.info"
$template PerHostMailWarn,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/mail.warn"
$template PerHostMailErr,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/mail.err"
$template PerHostNewsCrit,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/news.crit"
$template PerHostNewsErr,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/news.err"
$template PerHostNewsNotice,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/news.notice"
$template PerHostDebug,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/debug"
$template PerHostMessages,"<%= node[:rackspace_rsyslog][:config][:log_dir] %>/<%= node[:rackspace_rsyslog][:config][:per_host_dir] %>/messages"

auth,authpriv.*         ?PerHostAuth
*.*;auth,authpriv.none  -?PerHostSyslog
cron.*                  ?PerHostCron
daemon.*                -?PerHostDaemon
kern.*                  -?PerHostKern
lpr.*                   -?PerHostLpr
mail.*                  -?PerHostMail
user.*                  -?PerHostUser

mail.info               -?PerHostMailInfo
mail.warn               ?PerHostMailWarn
mail.err                ?PerHostMailErr

news.crit               ?PerHostNewsCrit
news.err                ?PerHostNewsErr
news.notice             -?PerHostNewsNotice

*.=debug;\
  auth,authpriv.none;\
  news.none;mail.none   -?PerHostDebug

*.=info;*.=notice;*.=warn;\
  auth,authpriv.none;\
  cron,daemon.none;\
  mail,news.none        -?PerHostMessages

#
# Stop processing of all non-local messages. You can process remote messages
# on levels less than 35.
#
:fromhost-ip,!isequal,"127.0.0.1" ~
